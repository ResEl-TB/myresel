{% extends 'base.html' %}
{% load i18n %}
{% load staticfiles %}

{% block css %}
    <link href="{% static 'css/home.css' %}" rel="stylesheet">
{% endblock %}

{% block titre %}F.A.Q.{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-lg-12">
            {# Affichage normal de la page #}
            <div class="home-fragment home-user-management">
                <div class="container">
                    <div class="row">
                        <h2>{% trans "Foire aux questions" %}</h2>
        	            <p>Vous trouverez ici les réponses aux questions qui nous sont fréquement posées.</p>
                      <p>Une question que vous vous posez n'est pas présente ? Vous pensez qu'elle mérite sa place sur cette page ? <a href="{% url 'contact' %}">Contactez-nous.</a></p>
                    </div>
                </div>
            </div>
            <div class="home-fragment home-presentation">
                <div class="container text-left">
                    {% for question in questions %}
                        {% if forloop.first %}{% endif %}<div class="panel panel-info">
                        <div class="panel-heading"><h3 id="{{ question.id }}" class="panel-title faq-question" style="cursor: pointer;"><b>{{ question.question_text }}</b></h3></div>
                        <div class="panel-body" style="display: none;">{{ question.response|safe }} <a id="{{ question.id }}" class="vote" href="javascript:void(false)">{% trans "Cette réponse m'a été utile" %}</a> </div>
                        </div>{% if forloop.last %}{% endif %}
                    {% empty %}
                    <p>{% trans "Pas de question à l'horizon" %}</p>
                    {% endfor %}
                </div>
          </div>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
{% endblock %}

{% block javascript %}
<script type="text/javascript">

$(function() {
  $(".faq-question").click(function() {
    $(this).parent().next().toggle();
  });

  $(".vote").click(function() {
    var id = $(this).prop("id");
    var $response = $("<span style='color: gray'>...</span>");
    $(this).replaceWith($response);

    $.ajax({
      type:"POST",
      url:"/faq/upvote/",
      data: {
        'faq_id': id,
        'csrfmiddlewaretoken': '{{ csrf_token }}'
      }
    }).done(function( data ) {
      $response.text("Votre commentaire à bien été pris en compte.");
      console.log( data );
    });
   });

});

</script>
{% endblock %}
