{% extends 'pages/home/home.html' %}
{% load i18n %}
{% load staticfiles %}

{% block myresel %}
    <style>
        .jumbotron {
            display: none;
        }
    </style>
    {# TODO: add validate email link (show if user_meta.email_validated == False) #}
    <div class="home-fragment home-user-management">
        <div class="container">
            <div class="row">
                <div class="col-sm-10">
                    <h2>My ResEl <small>{% trans "Gestion de mon compte ResEl" %}</small></h2>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <h3>{% trans "Mes services" %}</h3>
                    <div class="services-group">
                        <div><a href="{% url 'gestion-machines:liste' %}"><span class="fa fa-cubes fa-fw"></span> {% trans "Consulter toutes mes machines inscrites" %}</a></div>
                        <div><a href="{% url 'gestion-machines:liste' %}#bandwidth"><span class="fa fa-tasks fa-fw"></span> {% trans "Consommation de bande passante" %}</a> <span class="label label-default"></span></div>
                    </div>
                    <div class="services-group">
                        <div><a href="{% url 'campus:clubs:my-clubs' %}"><span class="fa fa-group fa-fw"></span> {% trans "Gérer mes clubs et associations" %}</a> <span class="label label-default"></span></div>
                        <div><a href="{% url 'gestion-personnes:webmail' %}"><span class="fa fa-inbox fa-fw"></span> {% trans "Ma boîte mail ResEl" %}</a></div>
                        <div><a href="https://mlistes.resel.fr"><span class="fa fa-feed fa-fw"></span> {% trans "Mes listes de diffusion" %}</a></div>
                    </div>
                    <div class="services-group">
                        <div><a href="{% url 'gestion-personnes:personal-infos' %}"><span class="fa fa-user fa-fw"></span> {% trans "Modifier mes informations personnelles" %}</a></div>
                        {# Temporarly to the webmail, but in the future we will add more settings #}
                        <div><a href="{% url 'gestion-personnes:mail' %}"><span class="fa fa-sliders fa-fw"></span> {% trans "Paramètres de mon compte" %}</a></div>
                        <div><a href="{% url 'gestion-personnes:mod-passwd' %}"><span class="fa fa-pencil-square fa-fw"></span> {% trans "Modifier mon mot de passe" %}</a></div>
                        <div><a href="{% url 'tresorerie:historique' %}"><span class="fa fa-history fa-fw"></span> {% trans "Historique de mes transactions" %}</a></div>
                    </div>
                </div>

                {% if is_resel %}
                    {% if not is_registered %}
                        {# In the netwok but not saved #}
                        <div class="col-md-6 col-md-offset-2">
                            <div class="row">
                                <div class="col-sm-4 computer-icon hidden-xs"><span class="fa fa-fw fa-laptop"></span></div>
                                <div class="col-sm-7">
                                    <h3>{% trans "Machine non enregistrée" %}</h3>
                                    <div>{% trans "Afin de pouvoir bénéficier des services du Resel, vous devez enregistrer votre machine sur le réseau." %}</div>
                                    <a href="{% url 'gestion-machines:ajout' %}" class="btn btn-default btn-lg">{%  trans "Enregistrer" %} <span class="hidden-xs"> {% trans "mon ordinateur"%}</span> </a>
                                </div>
                            </div>
                        </div>
                    {% elif not_user_device %}
                        {# The current device is not associated with the account #}
                        <div class="col-md-6 col-md-offset-2">
                            <div class="row">
                                <div class="col-sm-4 computer-icon hidden-xs"><span class="fa fa-fw fa-laptop"></span></div>
                                <div class="col-sm-7">
                                    <div><h3>{% trans "Mauvais appareil" %}</div>
                                    <div>{% blocktrans %}
                                        Vous êtes connecté sur un appareil qui ne vous appartient pas.
                                        Vous ne pouvez donc pas l'administrer.
                                        {% endblocktrans %}</div>
                                    <small>{% trans "Nous vous rappellons votre compte ResEl est strictement personnel et ne doit en aucun cas être partagé." %}</small>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        {# In the netwok and saved #}
                        <div class="col-md-6 col-md-offset-2">
                            <div class="row">
                                <div class="col-sm-4 computer-icon hidden-xs"><span class="fa fa-fw fa-laptop"></span></div>
                                <div class="col-sm-7">
                                    <div><h3>{% if device.aliases %}
                                            {{ device.aliases|first|capfirst }}
                                            {% else %}
                                            {{ device.hostname|capfirst }}
                                            {% endif %}

                                            <small><a href="{% url 'gestion-machines:modifier' device.hostname %}" class="fa fa-pencil fa-fw"></a></small></h3></div>
                                    <div><span class="label label-success">{% trans "Connecté au ResEl" %}</span></div>
                                    <br />
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% else %}
                    {# Not in the network #}
                    <div class="col-md-6 col-md-offset-2">
                        <div class="row">
                            <div class="col-xs-5 col-sm-3 computer-icon"><span class="fa fa-fw fa-globe"></span></div>
                            <div class="col-xs-7">
                                <h3>{% trans "Hors campus" %}</h3>
                                <div>{% trans "Vous êtes actuellement hors du campus d'IMT Atlantique." %}</div>
                                <small>{% trans "Vos actions sont limitées" %}</small>
                            </div>
                        </div>
                    </div>
                {% endif %}
                <div class="col-sm-3 col-sm-offset-3 hidden-xs hidden-sm"><hr /></div>
                {% if need_to_pay == 'success' %}
                    <div class="col-md-6 col-md-offset-2 payement-block">
                        <div class="row">
                            <div class="col-xs-5 col-sm-3 hidden-xs computer-icon">
                                <span class="fa fa-fw fa-check "></span>
                            </div>
                            <div class="col-sm-7">
                                <h3>{% trans "Facturation à jour" %}</h3>
                                {% if ldapuser.is_member %}
                                    <div><span class="fa fa-fw fa-circle success"></span> {% trans "Cotisation à l'association payée" %}</div>
                                {% else %}
                                    <div class=""><span class="fa fa-fw fa-circle danger" ></span> {% trans "Cotisation à l'association non payée" %}</div>
                                {% endif %}
                                <div><span class="fa fa-fw fa-circle success"></span> {% trans "Internet jusqu'au" %} {{ end_fee|date:"j F Y" }}</div>
                            <a href="{% url 'tresorerie:historique' %}" class="btn btn-default btn-lg">{%  trans "Consulter mes transactions"%}</a>
                            </div>
                        </div>
                    </div>
                {% elif need_to_pay == 'warning' %}
                    <div class="col-md-6 col-md-offset-2 payement-block">
                        <div class="row">
                            <div class="col-xs-5 col-sm-3 computer-icon warning"><span class="fa fa-fw fa-exclamation hidden-xs"></span></div>
                            <div class="col-sm-7">
                                <h3>{% trans "Attention abonnement" %}</h3>
                                {% if ldapuser.is_member %}
                                    <div><span class="fa fa-fw fa-circle success "></span> {% trans "Cotisation à l'association payée" %}</div>
                                {% else %}
                                    <div class=""><span class="fa fa-fw fa-circle danger" ></span> {% trans "Cotisation à l'association non payée" %}</div>
                                {% endif %}
                                <div><span class="fa fa-fw fa-circle warning"></span> {% trans "Internet jusqu'au" %} {{ end_fee|date:"j F Y" }}</div>
                                <a href="{% url 'tresorerie:home' %}" class="btn btn-default btn-lg">{%  trans "Effectuer un paiement"%}</a>
                            </div>
                        </div>
                    </div>
                {% elif need_to_pay == 'danger' %}
                    <div class="col-md-6 col-md-offset-2">
                        <div class="row">
                            <div class="col-xs-5 col-sm-3 computer-icon hidden-xs danger"><span class="fa fa-times"></span></div>
                            <div class="col-sm-7">
                                <h3>{% trans "Paiement non à jour" %}</h3>
                                {% if ldapuser.is_member %}
                                    <div><span class="fa fa-fw fa-circle success"></span> {% trans "Cotisation à l'association payée" %}</div>
                                {% else %}
                                    <div class=""><span class="fa fa-fw fa-circle danger" ></span> {% trans "Cotisation à l'association non payée" %}</div>
                                {% endif %}
                                <div><span class="fa fa-fw fa-circle danger"></span> {% trans "Accès internet expiré le" %} {{ end_fee|date:"j F Y" }}</div>
                                                            <div class="warning">{% trans "Votre abonnement au Resel a expiré, pour pouvoir à nouveau utiliser nos services vous devez régulariser votre situation." %}</div>

                                <a href="{% url 'tresorerie:home' %}" class="btn btn-default btn-lg ">{%  trans "Effectuer un paiement"%}</a>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="col-md-6 col-md-offset-2">
                        <div class="row">
                            <div class="col-sm-3 computer-icon hidden-xs"><span class="fa fa-minus"></span></div>
                            <div class="col-sm-7">
                                <h3>{% trans "Pas d'information de facturation" %}</h3>
                                <div>Vous ne semblez pas élibible à la cotisation ResEl.</div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
